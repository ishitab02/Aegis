{
  "name": "Reentrancy Attack on MockProtocol",
  "description": "A simulated reentrancy attack that drains 25% of protocol TVL, triggering AEGIS sentinel consensus and circuit breaker activation.",
  "steps": [
    {
      "step": 1,
      "name": "Setup",
      "description": "MockProtocol has 100 ETH TVL. All 3 sentinels active. Dashboard green.",
      "duration_seconds": 0
    },
    {
      "step": 2,
      "name": "Attack Begins",
      "description": "Attacker deploys exploit contract. Calls withdraw() with reentrancy callback.",
      "duration_seconds": 2
    },
    {
      "step": 3,
      "name": "TVL Drops 25%",
      "description": "Rapid recursive withdrawals drain 25 ETH from the pool.",
      "duration_seconds": 3
    },
    {
      "step": 4,
      "name": "Sentinel Detection",
      "description": "Liquidity Sentinel: CRITICAL (25% drop). Oracle Sentinel: HIGH (price deviation). Governance: NONE.",
      "duration_seconds": 5
    },
    {
      "step": 5,
      "name": "Consensus Reached",
      "description": "2/3 sentinels agree on HIGH+ threat. Action: CIRCUIT_BREAKER.",
      "duration_seconds": 7
    },
    {
      "step": 6,
      "name": "Circuit Breaker Triggered",
      "description": "CRE workflow calls CircuitBreaker.triggerBreaker(). Protocol paused. No more withdrawals possible.",
      "duration_seconds": 10
    },
    {
      "step": 7,
      "name": "Forensic Analysis",
      "description": "ChainSherlock traces the attack. Classifies as REENTRANCY with 0.92 confidence.",
      "duration_seconds": 30
    },
    {
      "step": 8,
      "name": "Report Stored",
      "description": "Forensic report hash stored on-chain via ThreatReport contract.",
      "duration_seconds": 35
    },
    {
      "step": 9,
      "name": "Recovery",
      "description": "After cooldown, CircuitBreaker.resetBreaker() is called. Protocol resumes.",
      "duration_seconds": 60
    }
  ],
  "expected_outcomes": {
    "total_detection_time_seconds": 12,
    "funds_saved_percent": 75,
    "sentinel_votes": {
      "liquidity": "CRITICAL",
      "oracle": "HIGH",
      "governance": "NONE"
    },
    "consensus": "CRITICAL",
    "action": "CIRCUIT_BREAKER"
  }
}
